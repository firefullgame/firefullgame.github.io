(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-dapp-test1"],{"5c72":function(t,e,o){"use strict";var n,a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",[o("v-uni-view",{},[o("v-uni-input",{attrs:{type:"text",value:""},model:{value:t.people,callback:function(e){t.people=e},expression:"people"}}),o("v-uni-button",{attrs:{type:"default"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.test2(1,t.people)}}},[t._v("test2")])],1),o("v-uni-view",{},[o("v-uni-input",{attrs:{type:"text",value:""},model:{value:t.start,callback:function(e){t.start=e},expression:"start"}}),o("v-uni-input",{attrs:{type:"text",value:""},model:{value:t.rounds,callback:function(e){t.rounds=e},expression:"rounds"}}),o("v-uni-button",{attrs:{type:"default"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.test3(t.start,t.rounds)}}},[t._v("test3")])],1)],1)},c=[];o.d(e,"b",(function(){return a})),o.d(e,"c",(function(){return c})),o.d(e,"a",(function(){return n}))},"5e98":function(t,e,o){"use strict";(function(t){var n;o("a15b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={name:"test",data:function(){return{gameScale:0,periods:0,periodData:{},burnTicket:0,people:0,rounds:0,start:0,totalSyn:0}},created:function(){n=this},methods:{toWei:function(t){return n.$common.web3.utils.toWei(t)},fromWei:function(t){return n.$common.web3.utils.fromWei(t)},test1:function(){var e="10";uni.request({url:"/static/abi/GAME.json",method:"GET",success:function(o){n.$common.gameContract=new n.$common.web3.eth.Contract(o.data,n.$common.game_contract_address),n.$common.gameContract.setProvider(n.$common.provider),n.$common.gameContract.methods.periods().call((function(o,a){n.periods=a;var c=n.periods;t("log","当前期数",c," at pages/dapp/test1.vue:56"),n.$common.gameContract.methods.getProgressScale().call((function(o,a){var r=n.fromWei(a);n.$common.gameContract.methods.gameProgress(c).call((function(o,a){n.periodData=a;var s=n.fromWei(n.periodData.supply);t("log","当期需求销毁数量",s," at pages/dapp/test1.vue:68");var u=n.fromWei(n.periodData.count);t("log","合约已经销毁",u," at pages/dapp/test1.vue:70"),s<=u+r*e&&t("log","请手动结束第",c,"期"," at pages/dapp/test1.vue:73");var i="0xaF595f322f753ce900E13E94bc8cA016ccf56e76",m=n.toWei(e);n.$common.gameContract.methods.join(n.$common.game_contract_address).send({from:i,value:m,gas:3e6}).on("receipt",(function(t){t.status&&n.test1()}))}))}))}))}})},test2:function(e,o){if(t("log",1," at pages/dapp/test1.vue:102"),!(o>e)){e++;var a=10;uni.request({url:"/static/abi/FPT.json",method:"GET",success:function(c){var r,s;n.$common.tokenContract=new n.$common.web3.eth.Contract(c.data,n.$common.contract_address),n.$common.tokenContract.setProvider(n.$common.provider),n.$common.web3.eth.getAccounts().then((function(c){r=c[0],n.$common.web3.eth.personal.newAccount("123456").then((function(c){s=c,t("log","当前操作地址",r," at pages/dapp/test1.vue:123");var u=a+20;t("log","参与游戏账号",s," at pages/dapp/test1.vue:125"),u=n.toWei(u+""),n.$common.web3.eth.sendTransaction({from:r,to:s,value:u}).on("receipt",(function(c){var u=n.toWei(a+"");n.$common.web3.eth.personal.unlockAccount(s,"123456",60).then((function(a,i){c.status?n.$common.tokenContract.methods.buy(n.$common.contract_address).send({from:s,value:u,gas:3e6}).on("receipt",(function(t){t.status&&n.test21(s,r,e,o)})):t("log",c," at pages/dapp/test1.vue:152")}))}))}))}))}})}},test21:function(e,o,a,c){uni.request({url:"/static/abi/GAME.json",method:"GET",success:function(r){n.$common.gameContract=new n.$common.web3.eth.Contract(r.data,n.$common.game_contract_address),n.$common.gameContract.setProvider(n.$common.provider);var s=n.toWei("6");n.$common.gameContract.methods.join(o).send({from:e,value:s,gas:3e6}).on("receipt",(function(e){t("log","进入下一个"," at pages/dapp/test1.vue:176"),e.status&&(a++,n.test2(a,c))}))}})},test3:function(e,o){t("log","开始轮",e," at pages/dapp/test1.vue:189"),t("log","结束轮",o," at pages/dapp/test1.vue:190");var a=0;uni.request({url:"/static/abi/GAME.json",method:"GET",success:function(c){n.$common.gameContract=new n.$common.web3.eth.Contract(c.data,n.$common.game_contract_address),n.$common.gameContract.setProvider(n.$common.provider),n.$common.gameContract.methods.rounds(e).call((function(c,r){var s=n.fromWei(r["totalInput"]),u=n.fromWei(r["currentJoin"]);if(1*e>1*o)return t("log",n.totalSyn," at pages/dapp/test1.vue:204"),0;t("log","当前加入总人数：",u,"--当前总参与数量",s," at pages/dapp/test1.vue:207"),a=1/u*(.35*s),t("log",a," at pages/dapp/test1.vue:209"),++e,n.totalSyn=n.totalSyn+a,t("log",n.totalSyn," at pages/dapp/test1.vue:212"),n.test3(e,o)}))}})}}};e.default=a}).call(this,o("0de9")["log"])},"65e7":function(t,e,o){"use strict";o.r(e);var n=o("5e98"),a=o.n(n);for(var c in n)"default"!==c&&function(t){o.d(e,t,(function(){return n[t]}))}(c);e["default"]=a.a},c1e0:function(t,e,o){"use strict";o.r(e);var n=o("5c72"),a=o("65e7");for(var c in a)"default"!==c&&function(t){o.d(e,t,(function(){return a[t]}))}(c);var r,s=o("f0c5"),u=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"ab3a9972",null,!1,n["a"],r);e["default"]=u.exports}}]);
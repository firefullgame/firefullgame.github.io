(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-dapp-test2"],{"0194":function(t,e,o){"use strict";o.r(e);var n=o("4bbe"),a=o("25bc");for(var c in a)"default"!==c&&function(t){o.d(e,t,(function(){return a[t]}))}(c);var s,r=o("f0c5"),u=Object(r["a"])(a["default"],n["b"],n["c"],!1,null,"b4f05cf4",null,!1,n["a"],s);e["default"]=u.exports},"25bc":function(t,e,o){"use strict";o.r(e);var n=o("27f2"),a=o.n(n);for(var c in n)"default"!==c&&function(t){o.d(e,t,(function(){return n[t]}))}(c);e["default"]=a.a},"27f2":function(t,e,o){"use strict";(function(t){var n=o("ee27");o("a15b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,o("96cf");var a,c=n(o("c964")),s=n(o("21ce")),r={name:"test",data:function(){return{index:1,yIndex:5,ceng:1,people:1,gasUse:0,frist:"TNgk7Fkdjc8A4SzzFKhJ1tRQFbH9e2vRLE"}},created:function(){a=this;var e=s.default.providers.HttpProvider,o=new e("http://127.0.0.1:9090"),n=new s.default(o,o);a.$common.tronWeb=n,t("log",n," at pages/dapp/test2.vue:39"),a.test4()},methods:{toWei:function(t){return a.$common.web3.utils.toWei(t)},fromWei:function(t){return a.$common.web3.utils.fromWei(t)},test1:function(){var e="10";uni.request({url:"/static/abi/GAME.json",method:"GET",success:function(o){a.$common.gameContract=new a.$common.web3.eth.Contract(o.data,a.$common.game_contract_address),a.$common.gameContract.setProvider(a.$common.provider),a.$common.gameContract.methods.periods().call((function(o,n){a.periods=n;var c=a.periods;t("log","当前期数",c," at pages/dapp/test2.vue:64"),a.$common.gameContract.methods.getProgressScale().call((function(o,n){var s=a.fromWei(n);a.$common.gameContract.methods.gameProgress(c).call((function(o,n){a.periodData=n;var r=a.fromWei(a.periodData.supply);t("log","当期需求销毁数量",r," at pages/dapp/test2.vue:76");var u=a.fromWei(a.periodData.count);t("log","合约已经销毁",u," at pages/dapp/test2.vue:78"),r<=u+s*e&&t("log","请手动结束第",c,"期"," at pages/dapp/test2.vue:81");var i="0xaF595f322f753ce900E13E94bc8cA016ccf56e76",m=a.toWei(e);a.$common.gameContract.methods.join(a.$common.game_contract_address).send({from:i,value:m,gas:3e6}).on("receipt",(function(t){t.status&&a.test1()}))}))}))}))}})},test:function(t){a.ceng=1,a.test2(a.frist,t)},test2:function(e,o){t("log","第",a.ceng,"层"," at pages/dapp/test2.vue:111"),t("log","第",a.index,"个"," at pages/dapp/test2.vue:112");var n=1;uni.request({url:"/static/abi/FPT.json",method:"GET",success:function(c){var s,r;a.$common.tokenContract=new a.$common.web3.eth.Contract(c.data,a.$common.contract_address),a.$common.tokenContract.setProvider(a.$common.provider),a.$common.web3.eth.getAccounts().then((function(c){s=c[0],a.$common.web3.eth.personal.newAccount("123456").then((function(c){r=c,t("log","当前操作地址",e," at pages/dapp/test2.vue:128");var u=n+12;t("log","参与游戏账号",r," at pages/dapp/test2.vue:130"),u=a.toWei(u+""),a.$common.web3.eth.sendTransaction({from:s,to:r,value:u}).on("receipt",(function(c){var u=a.toWei(n+"");a.$common.web3.eth.personal.unlockAccount(r,"123456",60).then((function(n,i){c.status?a.$common.tokenContract.methods.buy(s).send({from:r,value:u,gas:6e5}).on("receipt",(function(t){t.status&&a.test21(r,e,o)})):t("log",c," at pages/dapp/test2.vue:157")}))}))}))}))}})},test21:function(e,o,n){uni.request({url:"/static/abi/GAME.json",method:"GET",success:function(c){a.$common.gameContract=new a.$common.web3.eth.Contract(c.data,a.$common.game_contract_address),a.$common.gameContract.setProvider(a.$common.provider);var s=a.toWei("10");a.$common.gameContract.methods.join(o).send({from:e,value:s,gas:3e6}).on("receipt",(function(c){if(t("log","进入下一个"," at pages/dapp/test2.vue:180"),c.status){if(t("log","当前最大人数",a.yIndex," at pages/dapp/test2.vue:183"),a.index==a.yIndex&&(a.ceng++,a.index=0,o=e,a.ceng>n))return;var s=c.gasUsed;s>a.gasUsed&&(a.gasUsed=s),a.index++,setTimeout((function(){a.test2(o,n)}),3e3)}}))}})},test3:function(e,o){t("log","开始轮",e," at pages/dapp/test2.vue:220"),t("log","结束轮",o," at pages/dapp/test2.vue:221");var n=0;uni.request({url:"/static/abi/GAME.json",method:"GET",success:function(c){a.$common.gameContract=new a.$common.web3.eth.Contract(c.data,a.$common.game_contract_address),a.$common.gameContract.setProvider(a.$common.provider),a.$common.gameContract.methods.rounds(e).call((function(c,s){var r=a.fromWei(s["totalInput"]),u=a.fromWei(s["currentJoin"]);if(1*e>1*o)return t("log",a.totalSyn," at pages/dapp/test2.vue:235"),0;t("log","当前加入总人数：",u,"--当前总参与数量",r," at pages/dapp/test2.vue:238"),n=1/u*(.35*r),t("log",n," at pages/dapp/test2.vue:240"),++e,a.totalSyn=a.totalSyn+n,t("log",a.totalSyn," at pages/dapp/test2.vue:243"),a.test3(e,o)}))}})},test4:function(){return(0,c.default)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a.$common.tronWeb.getEventResult(a.$common.game_contract_address,{eventName:"ProfitRewardEvent",filters:{}}).then((function(t){}));case 1:case"end":return t.stop()}}),t)})))()},test5:function(e,o){uni.request({url:"/static/abi/GAME.json",method:"GET",success:function(n){a.$common.gameContract=new a.$common.web3.eth.Contract(n.data,a.$common.game_contract_address),a.$common.gameContract.setProvider(a.$common.provider);var c=a.toWei("10");a.$common.gameContract.methods.join(a.$common.game_contract_address).send({from:e,value:c,gas:3e6}).on("receipt",(function(n){if(t("log","进入下一个"," at pages/dapp/test2.vue:277"),t("log","第",a.ceng,"轮"," at pages/dapp/test2.vue:278"),t("log","第",a.index,"次"," at pages/dapp/test2.vue:279"),n.status){if(11==a.index&&(a.ceng++,a.index=0,t("log","达到11次进入下一轮"," at pages/dapp/test2.vue:285"),t("log",o," at pages/dapp/test2.vue:286"),t("log",a.ceng>o," at pages/dapp/test2.vue:288"),a.ceng>o))return;var c=n.gasUsed;c>a.gasUsed&&(a.gasUsed=c),a.index++,a.test5(e,o)}}))}})},test6:function(e){t("log","第",a.index,"个"," at pages/dapp/test2.vue:307");var o=10;uni.request({url:"/static/abi/FPT.json",method:"GET",success:function(n){var c,s;a.$common.tokenContract=new a.$common.web3.eth.Contract(n.data,a.$common.contract_address),a.$common.tokenContract.setProvider(a.$common.provider),t("log","参与游戏账号",s," at pages/dapp/test2.vue:319"),a.$common.web3.eth.getAccounts().then((function(n){if(c=n[0],s=n[a.index],0==a.index)a.test61(s,e);else{var r=o+13;r=a.toWei(r+""),a.$common.web3.eth.sendTransaction({from:c,to:s,value:r}).on("receipt",(function(n){var r=a.toWei(o+"");n.status?a.$common.tokenContract.methods.buy(c).send({from:s,value:r,gas:6e5}).on("receipt",(function(t){t.status&&a.test61(s,e)})):t("log",n," at pages/dapp/test2.vue:349")}))}}))}})},test61:function(e,o){uni.request({url:"/static/abi/GAME.json",method:"GET",success:function(n){a.$common.gameContract=new a.$common.web3.eth.Contract(n.data,a.$common.game_contract_address),a.$common.gameContract.setProvider(a.$common.provider);var c=a.toWei("10");a.$common.gameContract.methods.join(a.$common.game_contract_address).send({from:e,value:c,gas:3e6}).on("receipt",(function(e){if(t("log","进入下一个"," at pages/dapp/test2.vue:371"),e.status){if(a.index==a.people)return;a.index++,a.test6(o)}}))}})}}};e.default=r}).call(this,o("0de9")["log"])},"4bbe":function(t,e,o){"use strict";var n,a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",[o("v-uni-view",{},[o("v-uni-input",{attrs:{type:"text",value:""},model:{value:t.people,callback:function(e){t.people=e},expression:"people"}}),o("v-uni-button",{attrs:{type:"default"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.test(t.people)}}},[t._v("test2")])],1),o("v-uni-view",{},[o("v-uni-input",{attrs:{type:"text",value:""},model:{value:t.people,callback:function(e){t.people=e},expression:"people"}}),o("v-uni-button",{attrs:{type:"default"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.test6(t.people)}}},[t._v("test6")])],1)],1)},c=[];o.d(e,"b",(function(){return a})),o.d(e,"c",(function(){return c})),o.d(e,"a",(function(){return n}))}}]);